{
  "hash": "5f616e764dfa2ef1f3fe594297220fb4",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"imfp Demo Project\"\n---\n\n\n\n\nThis data analysis project aims to explore the relationship between economic growth and gender equality using `imfp`, which allows us to download data from IMF (International Monetary Fund). `imfp` can be integrated with other python tools to streamline the computational process. To demonstrate its functionality, the project experimented with a variety of visualization and analysis methods. \n\n## Executive Summary\n\nIn this project, we explored the following:\n\n1. **Data Fetching**\n* Make API call to fetch 4 datasets: GII (Gender Inequality Index), Nominal GDP, GDP Deflator Index, Population series\n\n2. **Feature Engineering**\n* Cleaning: Convert GDP Deflator Index to a yearly basis and variables to numeric\n* Dependent Variable: Percent Change of Gender Inequality Index\n* Independent Variable: Percent Change of Real GDP per Capita \n* Transform variables to display magnitude of change \n* Merge the datasets\n\n3. **Data Visualization**\n* Scatterplot\n* Time Series Line Plots\n* Barplot\n* Boxplot\n* Heatmap\n\n4. **Statistical Analysis**\n* Descriptive Statistics\n* Regression Analysis\n* Time Series Analysis\n\n## Suggested packages\nThe integration of other Python tools not only streamlined our computational processes but also ensured consistency across the project.\n\nA custom module is written to simplify the process of making API calls and fetching information with imfp library. `load_or_fetch_databases`, `load_or_fetch_parameters` `load_or_fetch_dataset` load and retreive database, parameters, and dataset from a local or remote source. `view_dataframe_in_browser` displays dataframe in a web browser.\n\n::: {#3f9622bd .cell execution_count=1}\n``` {.python .cell-code}\nimport os\nimport pickle\nfrom tempfile import NamedTemporaryFile\nimport pandas as pd\nimport imfp\nimport webbrowser\n\n\n# Function to display a DataFrame in a web browser\ndef view_dataframe_in_browser(df):\n    html = df.to_html()\n    with NamedTemporaryFile(delete=False, mode=\"w\", suffix=\".html\") as f:\n        url = \"file://\" + f.name\n        f.write(html)\n    webbrowser.open(url)\n\n\n# Function to load databases from CSV or fetch from API\ndef load_or_fetch_databases():\n    csv_path = os.path.join(\"data\", \"databases.csv\")\n\n    # Try to load from CSV\n    if os.path.exists(csv_path):\n        try:\n            return pd.read_csv(csv_path)\n        except Exception as e:\n            print(f\"Error loading CSV: {e}\")\n\n    # If CSV doesn't exist or couldn't be loaded, fetch from API\n    print(\"Fetching databases from IMF API...\")\n    databases = imfp.imf_databases()\n\n    # Save to CSV for future use\n    databases.to_csv(csv_path, index=False)\n    print(f\"Databases saved to {csv_path}\")\n\n    return databases\n\n\ndef load_or_fetch_parameters(database_name):\n    pickle_path = os.path.join(\"data\", f\"{database_name}.pickle\")\n\n    # Try to load from pickle file\n    if os.path.exists(pickle_path):\n        try:\n            with open(pickle_path, \"rb\") as f:\n                return pickle.load(f)\n        except Exception as e:\n            print(f\"Error loading pickle file: {e}\")\n\n    # If pickle doesn't exist or couldn't be loaded, fetch from API\n    print(f\"Fetching parameters for {database_name} from IMF API...\")\n    parameters = imfp.imf_parameters(database_name)\n\n    # Save to pickle file for future use\n    os.makedirs(\"data\", exist_ok=True)  # Ensure the data directory exists\n    with open(pickle_path, \"wb\") as f:\n        pickle.dump(parameters, f)\n    print(f\"Parameters saved to {pickle_path}\")\n\n    return parameters\n\n\ndef load_or_fetch_dataset(database_id, indicator):\n    file_name = f\"{database_id}.{indicator}.csv\"\n    csv_path = os.path.join(\"data\", file_name)\n\n    # Try to load from CSV file\n    if os.path.exists(csv_path):\n        try:\n            return pd.read_csv(csv_path)\n        except Exception as e:\n            print(f\"Error loading CSV file: {e}\")\n\n    # If CSV doesn't exist or couldn't be loaded, fetch from API\n    print(f\"Fetching dataset for {database_id}.{indicator} from IMF API...\")\n    dataset = imfp.imf_dataset(database_id=database_id, indicator=[indicator])\n\n    # Save to CSV file for future use\n    os.makedirs(\"data\", exist_ok=True)  # Ensure the data directory exists\n    dataset.to_csv(csv_path, index=False)\n    print(f\"Dataset saved to {csv_path}\")\n\n    return dataset\n```\n:::\n\n\nHere is a brief introduction about the packages used:\n\n`pandas`: view and manipulate data frame\n\n`matplotlib.pyplot`: make plots\n\n`seaborn`: make plots\n\n`numpy`: computation\n\n`LinearRegression`: implement linear regression\n\n`tabulate`: format data into tables\n\n`statsmodels.api`, `adfuller`, `ARIMA`,`VAR`,`plot_acf`,`plot_pacf`,`mean_absolute_error`,`mean_squared_error`, and`grangercausalitytests` are specifically used for time series analysis. \n\n::: {#a5fa1d71 .cell execution_count=2}\n``` {.python .cell-code}\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nfrom sklearn.linear_model import LinearRegression\nfrom tabulate import tabulate\nimport statsmodels.api as sm\nfrom statsmodels.tsa.stattools import adfuller\nfrom statsmodels.tsa.arima.model import ARIMA\nfrom statsmodels.tsa.vector_ar.var_model import VAR\nfrom statsmodels.graphics.tsaplots import plot_acf, plot_pacf\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.metrics import mean_squared_error\nfrom statsmodels.tsa.stattools import grangercausalitytests\n```\n:::\n\n\n## Data Fetching\nIn this section, we extracted four datasets through API calls: Gender Inequality Index(GII), GDP Deflator, Nominal GDP, and Population.  \n\n::: {#5140c2cf .cell execution_count=3}\n``` {.python .cell-code}\nfrom pathlib import Path\nPath(\"data\").mkdir(exist_ok=True)\n```\n:::\n\n\n::: {#030ed890 .cell execution_count=4}\n``` {.python .cell-code}\n# Load or fetch databases\ndatabases = load_or_fetch_databases()\n\n# Filter out databases that contain a year in the description\ndatabases[\n  ~databases['description'].str.contains(r\"[\\d]{4}\", regex=True)\n]\n\n# view_dataframe_in_browser(databases)\n```\n\n::: {.cell-output .cell-output-display execution_count=41}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>database_id</th>\n      <th>description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>25</th>\n      <td>HPDD</td>\n      <td>Historical Public Debt (HPDD)</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>RAFIT2AGG</td>\n      <td>Revenue Administration Fiscal Information Tool...</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>GENDER_EQUALITY</td>\n      <td>Gender Equality</td>\n    </tr>\n    <tr>\n      <th>63</th>\n      <td>PGCS</td>\n      <td>Private and Public Capital Stock Dataset</td>\n    </tr>\n    <tr>\n      <th>69</th>\n      <td>GENDER_BUDGETING</td>\n      <td>Gender Budgeting</td>\n    </tr>\n    <tr>\n      <th>125</th>\n      <td>CPI</td>\n      <td>Consumer Price Index (CPI)</td>\n    </tr>\n    <tr>\n      <th>153</th>\n      <td>IRFCL</td>\n      <td>International Reserves and Foreign Currency Li...</td>\n    </tr>\n    <tr>\n      <th>191</th>\n      <td>IFS_DISCONTINUED</td>\n      <td>International Financial Statistics (IFS), Disc...</td>\n    </tr>\n    <tr>\n      <th>192</th>\n      <td>EQ</td>\n      <td>Export Quality</td>\n    </tr>\n    <tr>\n      <th>193</th>\n      <td>ED</td>\n      <td>Export Diversification</td>\n    </tr>\n    <tr>\n      <th>226</th>\n      <td>FISCALDECENTRALIZATION</td>\n      <td>Fiscal Decentralization</td>\n    </tr>\n    <tr>\n      <th>291</th>\n      <td>FDI</td>\n      <td>Financial Development Index</td>\n    </tr>\n    <tr>\n      <th>292</th>\n      <td>PSBSFAD</td>\n      <td>Public Sector Balance Sheet (PSBS)(FAD)</td>\n    </tr>\n    <tr>\n      <th>293</th>\n      <td>UNSDG_IMF_INPUTS</td>\n      <td>Sustainable Development Goals, IMF Inputs</td>\n    </tr>\n    <tr>\n      <th>294</th>\n      <td>CPIS</td>\n      <td>Coordinated Portfolio Investment Survey (CPIS)</td>\n    </tr>\n    <tr>\n      <th>295</th>\n      <td>PCTOT</td>\n      <td>Commodity Terms of Trade</td>\n    </tr>\n    <tr>\n      <th>296</th>\n      <td>FM</td>\n      <td>Fiscal Monitor (FM)</td>\n    </tr>\n    <tr>\n      <th>297</th>\n      <td>AFRREO</td>\n      <td>Sub-Saharan Africa Regional Economic Outlook (...</td>\n    </tr>\n    <tr>\n      <th>298</th>\n      <td>WHDREO</td>\n      <td>Western Hemisphere Regional Economic Outlook (...</td>\n    </tr>\n    <tr>\n      <th>299</th>\n      <td>MCDREO</td>\n      <td>Middle East and Central Asia Regional Economic...</td>\n    </tr>\n    <tr>\n      <th>300</th>\n      <td>APDREO</td>\n      <td>Asia and Pacific Regional Economic Outlook (AP...</td>\n    </tr>\n    <tr>\n      <th>301</th>\n      <td>BOPAGG</td>\n      <td>Balance of Payments (BOP), World and Regional ...</td>\n    </tr>\n    <tr>\n      <th>302</th>\n      <td>PCPS</td>\n      <td>Primary Commodity Price System (PCPS)</td>\n    </tr>\n    <tr>\n      <th>303</th>\n      <td>CDIS</td>\n      <td>Coordinated Direct Investment Survey (CDIS)</td>\n    </tr>\n    <tr>\n      <th>304</th>\n      <td>BOP</td>\n      <td>Balance of Payments (BOP)</td>\n    </tr>\n    <tr>\n      <th>305</th>\n      <td>COFER</td>\n      <td>Currency Composition of Official Foreign Excha...</td>\n    </tr>\n    <tr>\n      <th>306</th>\n      <td>DOT</td>\n      <td>Direction of Trade Statistics (DOTS)</td>\n    </tr>\n    <tr>\n      <th>307</th>\n      <td>RAFIT3P</td>\n      <td>RA-FIT Round3 Completion and Participation Rates</td>\n    </tr>\n    <tr>\n      <th>308</th>\n      <td>FAS</td>\n      <td>Financial Access Survey (FAS)</td>\n    </tr>\n    <tr>\n      <th>309</th>\n      <td>FSI</td>\n      <td>Financial Soundness Indicators (FSIs)</td>\n    </tr>\n    <tr>\n      <th>310</th>\n      <td>FSIRE</td>\n      <td>Financial Soundness Indicators: Reporting enti...</td>\n    </tr>\n    <tr>\n      <th>311</th>\n      <td>BOPSDMXUSD</td>\n      <td>Balance of Payments (BOP), Global SDMX (US Dol...</td>\n    </tr>\n    <tr>\n      <th>312</th>\n      <td>NAMAIN_IDC_N</td>\n      <td>System of National Accounts (SNA), NA_MAIN</td>\n    </tr>\n    <tr>\n      <th>313</th>\n      <td>GFSR</td>\n      <td>Government Finance Statistics (GFS), Revenue</td>\n    </tr>\n    <tr>\n      <th>314</th>\n      <td>GFSSSUC</td>\n      <td>Government Finance Statistics (GFS), Statement...</td>\n    </tr>\n    <tr>\n      <th>315</th>\n      <td>GFSCOFOG</td>\n      <td>Government Finance Statistics (GFS), Expenditu...</td>\n    </tr>\n    <tr>\n      <th>316</th>\n      <td>GFSFALCS</td>\n      <td>Government Finance Statistics (GFS), Financial...</td>\n    </tr>\n    <tr>\n      <th>317</th>\n      <td>GFSIBS</td>\n      <td>Government Finance Statistics (GFS), Integrate...</td>\n    </tr>\n    <tr>\n      <th>318</th>\n      <td>GFSMAB</td>\n      <td>Government Finance Statistics (GFS), Main Aggr...</td>\n    </tr>\n    <tr>\n      <th>319</th>\n      <td>GFSE</td>\n      <td>Government Finance Statistics (GFS), Expense</td>\n    </tr>\n    <tr>\n      <th>320</th>\n      <td>IFS</td>\n      <td>International Financial Statistics (IFS)</td>\n    </tr>\n    <tr>\n      <th>321</th>\n      <td>MFS</td>\n      <td>Monetary and Financial Statistics (MFS)</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nTwo databases were used: Gender Equality and International Financial Statistics (IFS).\n\n::: {#facb3cfd .cell execution_count=5}\n``` {.python .cell-code}\ndatasets = [\"GENDER_EQUALITY\", \"IFS\"]\nparams = {}\n\n# Fetch valid parameters for two datasets\nfor dataset in datasets:\n    params[dataset] = load_or_fetch_parameters(dataset)\n\n    valid_keys = list(params[dataset].keys())\n    print(f\"Parameters for {dataset}: \", valid_keys)\n\n# view_dataframe_in_browser(params.get(\"IFS\").get(\"indicator\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nParameters for GENDER_EQUALITY:  ['freq', 'ref_area', 'indicator']\nParameters for IFS:  ['freq', 'ref_area', 'indicator']\n```\n:::\n:::\n\n\n“freq” stands for Frequency, such as Annual, Monthly, or Quarterly. \"ref_area\" stands for Geogrpahical Area, such as US (United States), JP (Japan), and GB (United Kindom). “indicator\" refers to the specific dataset in the database, including input code and description. For example, if we display all the indicators for IFS database, the GDP deflator dataset has an input code of \"NGDP_D_SA_IX\" with a full name description of Gross Domestic Product, Deflator, Seasonally Adjusted, Index. \n\nWe paired the database with the specific dataset indicator to read and store the csv file. \n\n::: {#c813cd4c .cell execution_count=6}\n``` {.python .cell-code}\ndatasets = {}\ndsets = [(\"GENDER_EQUALITY\", \"GE_GII\"), (\"IFS\", \"NGDP_D_SA_IX\"), (\"IFS\", \"NGDP_XDC\"), (\"IFS\", \"LP_PE_NUM\")]\n\nfor dset in dsets:\n    datasets[dset[0] + \".\" + dset[1]] = load_or_fetch_dataset(dset[0], dset[1])\n```\n:::\n\n\n::: {#111c2704 .cell execution_count=7}\n``` {.python .cell-code}\n# \"Gender Inequality Index\"\nGII = \"GENDER_EQUALITY.GE_GII\"\n\n# \"Gross Domestic Product, Deflator, Seasonally Adjusted, Index\"\nGDP_deflator = \"IFS.NGDP_D_SA_IX\"\n\n# \"Gross Domestic Product, Nominal, Domestic Currency\"\nGDP_nominal = \"IFS.NGDP_XDC\"\n\n# \"Population, Persons, Number of\"\nGDP_population = \"IFS.LP_PE_NUM\"\n\n# Assign the datasets to new variables so we don't change the originals\nGII_data = datasets[GII]\nGDP_deflator_data = datasets[GDP_deflator]\nGDP_nominal_data = datasets[GDP_nominal]\nGDP_population_data = datasets[GDP_population]\n```\n:::\n\n\n## Feature Engineering\n### Data Cleaning\nSince the GDP deflator was reported on a quarterly basis, we converted it to a yearly basis.\n\n::: {#bf2f0b5c .cell execution_count=8}\n``` {.python .cell-code}\n# Filter to keep only rows with a partial string match for \"Q4\" in the time_period column\nGDP_deflator_data = GDP_deflator_data[GDP_deflator_data['time_period'].str.contains(\"Q4\")]\n```\n:::\n\n\n::: {#a5127fcf .cell execution_count=9}\n``` {.python .cell-code}\n# Split the time_period into year and quarter and keep the year only\nGDP_deflator_data.loc[:, 'time_period'] = GDP_deflator_data['time_period'].str[0:4]\n```\n:::\n\n\nWe made all the variables numeric.\n\n::: {#5a83c256 .cell execution_count=10}\n``` {.python .cell-code}\ndatasets = [GII_data, GDP_deflator_data, GDP_nominal_data, GDP_population_data]\n\nfor i, dataset in enumerate(datasets):    \n    # Use .loc to modify the columns\n    datasets[i].loc[:, 'obs_value'] = pd.to_numeric(datasets[i]['obs_value'], errors='coerce')\n    datasets[i].loc[:, 'time_period'] = pd.to_numeric(datasets[i]['time_period'], errors='coerce')\n    datasets[i].loc[:, 'unit_mult'] = pd.to_numeric(datasets[i]['unit_mult'], errors='coerce')\n```\n:::\n\n\n### GII Percent Change: Dependent Variable\nWe kept percents as decimals to make them easy to work with for calculation. Different countries have different baseline level of economic growth and gender equality. We calculated the percent change to make them comparable. \n\n::: {#e5b05f21 .cell execution_count=11}\n``` {.python .cell-code}\n# Calculate percent change for each ref_area\nGII_data[f'pct_change'] = GII_data.sort_values(['ref_area', 'time_period']).groupby('ref_area')['obs_value'].pct_change()\n\n# Display the first few rows of the updated dataset\nGII_data.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=48}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>freq</th>\n      <th>ref_area</th>\n      <th>indicator</th>\n      <th>unit_mult</th>\n      <th>time_format</th>\n      <th>time_period</th>\n      <th>obs_value</th>\n      <th>pct_change</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>A</td>\n      <td>AF</td>\n      <td>GE_GII</td>\n      <td>0</td>\n      <td>P1Y</td>\n      <td>1990</td>\n      <td>0.828244</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>A</td>\n      <td>AF</td>\n      <td>GE_GII</td>\n      <td>0</td>\n      <td>P1Y</td>\n      <td>1991</td>\n      <td>0.817706</td>\n      <td>-0.012723</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>A</td>\n      <td>AF</td>\n      <td>GE_GII</td>\n      <td>0</td>\n      <td>P1Y</td>\n      <td>1992</td>\n      <td>0.809806</td>\n      <td>-0.009662</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>A</td>\n      <td>AF</td>\n      <td>GE_GII</td>\n      <td>0</td>\n      <td>P1Y</td>\n      <td>1993</td>\n      <td>0.803078</td>\n      <td>-0.008308</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>A</td>\n      <td>AF</td>\n      <td>GE_GII</td>\n      <td>0</td>\n      <td>P1Y</td>\n      <td>1994</td>\n      <td>0.797028</td>\n      <td>-0.007533</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nWe subset the data frame to keep only the columns we want:\n\n::: {#beba6690 .cell execution_count=12}\n``` {.python .cell-code}\n# Create a new dataframe with only the required columns\nGII_data = GII_data[['ref_area', 'time_period', 'pct_change']].copy()\n\n# Display the first few rows of the new dataset\nGII_data.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=49}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ref_area</th>\n      <th>time_period</th>\n      <th>pct_change</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>AF</td>\n      <td>1990</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>AF</td>\n      <td>1991</td>\n      <td>-0.012723</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>AF</td>\n      <td>1992</td>\n      <td>-0.009662</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>AF</td>\n      <td>1993</td>\n      <td>-0.008308</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>AF</td>\n      <td>1994</td>\n      <td>-0.007533</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### GDP: Independent Variable\nWe kept the columns we want only for GDP-related datasets for easier table merging.\n\n::: {#dcb5d0f4 .cell execution_count=13}\n``` {.python .cell-code}\n# GDP Deflator Dataset\n# Create a new dataframe with only the required columns\nGDP_deflator_data = GDP_deflator_data[['ref_area', 'time_period', 'unit_mult', 'obs_value']].copy()\n\n# Divide obs_value by 100\nGDP_deflator_data['obs_value'] = GDP_deflator_data['obs_value'] / 100\n\n# Display the first few rows of the new dataset\nGDP_deflator_data.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=50}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ref_area</th>\n      <th>time_period</th>\n      <th>unit_mult</th>\n      <th>obs_value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>3</th>\n      <td>FI</td>\n      <td>1990</td>\n      <td>0</td>\n      <td>0.732006</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>FI</td>\n      <td>1991</td>\n      <td>0</td>\n      <td>0.739841</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>FI</td>\n      <td>1992</td>\n      <td>0</td>\n      <td>0.746543</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>FI</td>\n      <td>1993</td>\n      <td>0</td>\n      <td>0.756193</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>FI</td>\n      <td>1994</td>\n      <td>0</td>\n      <td>0.779373</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#5d7c9877 .cell execution_count=14}\n``` {.python .cell-code}\n# GDP Nominal Data\n# Create a new dataframe with only the required columns\nGDP_nominal_data = GDP_nominal_data[['ref_area', 'time_period', 'unit_mult','obs_value']].copy()\n\n# Display the first few rows of the new dataset\nGDP_nominal_data.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=51}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ref_area</th>\n      <th>time_period</th>\n      <th>unit_mult</th>\n      <th>obs_value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>NE</td>\n      <td>2005</td>\n      <td>6</td>\n      <td>2418864.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>NE</td>\n      <td>2006</td>\n      <td>6</td>\n      <td>2596972.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NE</td>\n      <td>2007</td>\n      <td>6</td>\n      <td>2762961.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>NE</td>\n      <td>2008</td>\n      <td>6</td>\n      <td>3247835.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>NE</td>\n      <td>2009</td>\n      <td>6</td>\n      <td>3403683.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#7a3c1825 .cell execution_count=15}\n``` {.python .cell-code}\n# GDP Population Data \n# Create a new dataframe with only the required columns\nGDP_population_data = GDP_population_data[['ref_area', 'time_period', 'unit_mult','obs_value']].copy()\n\n# Display the first few rows of the new dataset\nGDP_population_data.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=52}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ref_area</th>\n      <th>time_period</th>\n      <th>unit_mult</th>\n      <th>obs_value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>GA</td>\n      <td>1950</td>\n      <td>3</td>\n      <td>473.296</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>GA</td>\n      <td>1951</td>\n      <td>3</td>\n      <td>476.381</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>GA</td>\n      <td>1952</td>\n      <td>3</td>\n      <td>478.655</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>GA</td>\n      <td>1953</td>\n      <td>3</td>\n      <td>480.536</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>GA</td>\n      <td>1954</td>\n      <td>3</td>\n      <td>482.332</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#11e4fffa .cell execution_count=16}\n``` {.python .cell-code}\n# Combine all the datasets above for further calculation\nmerged_df = pd.merge(pd.merge(GDP_deflator_data,GDP_nominal_data, on=['time_period', 'ref_area'], suffixes=('_index', '_nominal'), how='inner'), GDP_population_data, on=['time_period', 'ref_area'], how='inner')\n\n# Display the GDP data in a web browser\n# view_dataframe_in_browser(merged_df)\n\n# Display the first few rows of the dataset\nmerged_df.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=53}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ref_area</th>\n      <th>time_period</th>\n      <th>unit_mult_index</th>\n      <th>obs_value_index</th>\n      <th>unit_mult_nominal</th>\n      <th>obs_value_nominal</th>\n      <th>unit_mult</th>\n      <th>obs_value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>FI</td>\n      <td>1990</td>\n      <td>0</td>\n      <td>0.732006</td>\n      <td>6</td>\n      <td>90964.0</td>\n      <td>3</td>\n      <td>4996.220</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>FI</td>\n      <td>1991</td>\n      <td>0</td>\n      <td>0.739841</td>\n      <td>6</td>\n      <td>86913.0</td>\n      <td>3</td>\n      <td>5019.134</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>FI</td>\n      <td>1992</td>\n      <td>0</td>\n      <td>0.746543</td>\n      <td>6</td>\n      <td>84786.0</td>\n      <td>3</td>\n      <td>5044.928</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>FI</td>\n      <td>1993</td>\n      <td>0</td>\n      <td>0.756193</td>\n      <td>6</td>\n      <td>85610.0</td>\n      <td>3</td>\n      <td>5071.782</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>FI</td>\n      <td>1994</td>\n      <td>0</td>\n      <td>0.779373</td>\n      <td>6</td>\n      <td>90646.0</td>\n      <td>3</td>\n      <td>5097.090</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nWe want to adjust GDP data based on unit multiplier. Unit multiplier stands for the number of zeroes we need to add to the value column. For example, in 1950, the observed population data for country GA (Georgia) was 473.296. With a unit muliplier of 3, the adjusted population would be 473296.\n\n::: {#d016f2b9 .cell execution_count=17}\n``` {.python .cell-code}\nmerged_df['adjusted_index'] = merged_df['obs_value_index'] * (10 ** (merged_df['unit_mult_index']))\nmerged_df['adjusted_nominal'] = merged_df['obs_value_nominal'] * (10 ** (merged_df['unit_mult_nominal']))\nmerged_df['adjusted_population'] = merged_df['obs_value'] * (10 ** (merged_df['unit_mult']))\n```\n:::\n\n\n::: {#3ff2aaf1 .cell execution_count=18}\n``` {.python .cell-code}\n# Merged dataset\n# Create a new dataframe with only the required columns\nmerged_df = merged_df[['ref_area', 'time_period','adjusted_nominal', 'adjusted_index', 'adjusted_population']].copy()\n\n# Display the first few rows of the dataset\nmerged_df.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=55}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ref_area</th>\n      <th>time_period</th>\n      <th>adjusted_nominal</th>\n      <th>adjusted_index</th>\n      <th>adjusted_population</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>FI</td>\n      <td>1990</td>\n      <td>9.096400e+10</td>\n      <td>0.732006</td>\n      <td>4996220.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>FI</td>\n      <td>1991</td>\n      <td>8.691300e+10</td>\n      <td>0.739841</td>\n      <td>5019134.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>FI</td>\n      <td>1992</td>\n      <td>8.478600e+10</td>\n      <td>0.746543</td>\n      <td>5044928.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>FI</td>\n      <td>1993</td>\n      <td>8.561000e+10</td>\n      <td>0.756193</td>\n      <td>5071782.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>FI</td>\n      <td>1994</td>\n      <td>9.064600e+10</td>\n      <td>0.779373</td>\n      <td>5097090.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nWe wanted to compute the Real GDP per capita.\n\n::: {#4a0d2ecf .cell execution_count=19}\n``` {.python .cell-code}\n# Step 1: Real GDP = (Nominal GDP / GDP Deflator Index)\nmerged_df['Real_GDP_domestic'] = (merged_df['adjusted_nominal'] / merged_df['adjusted_index'])\n\n# Step 2: Real GDP per Capita = Real GDP / Population\nmerged_df['Real_GDP_per_capita'] = merged_df['Real_GDP_domestic'] / merged_df['adjusted_population']\n\n# Check the results\nmerged_df.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=56}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ref_area</th>\n      <th>time_period</th>\n      <th>adjusted_nominal</th>\n      <th>adjusted_index</th>\n      <th>adjusted_population</th>\n      <th>Real_GDP_domestic</th>\n      <th>Real_GDP_per_capita</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>FI</td>\n      <td>1990</td>\n      <td>9.096400e+10</td>\n      <td>0.732006</td>\n      <td>4996220.0</td>\n      <td>1.242667e+11</td>\n      <td>24872.143699</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>FI</td>\n      <td>1991</td>\n      <td>8.691300e+10</td>\n      <td>0.739841</td>\n      <td>5019134.0</td>\n      <td>1.174753e+11</td>\n      <td>23405.490395</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>FI</td>\n      <td>1992</td>\n      <td>8.478600e+10</td>\n      <td>0.746543</td>\n      <td>5044928.0</td>\n      <td>1.135715e+11</td>\n      <td>22512.011198</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>FI</td>\n      <td>1993</td>\n      <td>8.561000e+10</td>\n      <td>0.756193</td>\n      <td>5071782.0</td>\n      <td>1.132119e+11</td>\n      <td>22321.919259</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>FI</td>\n      <td>1994</td>\n      <td>9.064600e+10</td>\n      <td>0.779373</td>\n      <td>5097090.0</td>\n      <td>1.163063e+11</td>\n      <td>22818.181344</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nWe calculated the percentage change in Real GDP per capita and put it in a new column.\n\n::: {#6649d43a .cell execution_count=20}\n``` {.python .cell-code}\n# Calculate percent change for each ref_area\nmerged_df[f'GDP_change'] = merged_df.sort_values(['ref_area', 'time_period']).groupby('ref_area')['Real_GDP_per_capita'].pct_change()\n\n# Rename dataset\nGDP_data = merged_df\n\n# Display the first few rows of the dataset\nGDP_data.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=57}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ref_area</th>\n      <th>time_period</th>\n      <th>adjusted_nominal</th>\n      <th>adjusted_index</th>\n      <th>adjusted_population</th>\n      <th>Real_GDP_domestic</th>\n      <th>Real_GDP_per_capita</th>\n      <th>GDP_change</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>FI</td>\n      <td>1990</td>\n      <td>9.096400e+10</td>\n      <td>0.732006</td>\n      <td>4996220.0</td>\n      <td>1.242667e+11</td>\n      <td>24872.143699</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>FI</td>\n      <td>1991</td>\n      <td>8.691300e+10</td>\n      <td>0.739841</td>\n      <td>5019134.0</td>\n      <td>1.174753e+11</td>\n      <td>23405.490395</td>\n      <td>-0.058968</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>FI</td>\n      <td>1992</td>\n      <td>8.478600e+10</td>\n      <td>0.746543</td>\n      <td>5044928.0</td>\n      <td>1.135715e+11</td>\n      <td>22512.011198</td>\n      <td>-0.038174</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>FI</td>\n      <td>1993</td>\n      <td>8.561000e+10</td>\n      <td>0.756193</td>\n      <td>5071782.0</td>\n      <td>1.132119e+11</td>\n      <td>22321.919259</td>\n      <td>-0.008444</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>FI</td>\n      <td>1994</td>\n      <td>9.064600e+10</td>\n      <td>0.779373</td>\n      <td>5097090.0</td>\n      <td>1.163063e+11</td>\n      <td>22818.181344</td>\n      <td>0.022232</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#70ca27ae .cell execution_count=21}\n``` {.python .cell-code}\n# GII and GDP\n# Merge the datasets\ncombined_data = pd.merge(GII_data, GDP_data, on=[\"ref_area\", \"time_period\"], how = \"inner\")\n\n# Check the combined dataset\ncombined_data.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=58}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ref_area</th>\n      <th>time_period</th>\n      <th>pct_change</th>\n      <th>adjusted_nominal</th>\n      <th>adjusted_index</th>\n      <th>adjusted_population</th>\n      <th>Real_GDP_domestic</th>\n      <th>Real_GDP_per_capita</th>\n      <th>GDP_change</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>AR</td>\n      <td>2004</td>\n      <td>-0.021896</td>\n      <td>4.851153e+11</td>\n      <td>0.409672</td>\n      <td>38491970.0</td>\n      <td>1.184155e+12</td>\n      <td>30763.687776</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>AR</td>\n      <td>2005</td>\n      <td>-0.008581</td>\n      <td>5.825382e+11</td>\n      <td>0.470108</td>\n      <td>38892924.0</td>\n      <td>1.239159e+12</td>\n      <td>31860.772776</td>\n      <td>0.035662</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>AR</td>\n      <td>2006</td>\n      <td>0.007379</td>\n      <td>7.159043e+11</td>\n      <td>0.526535</td>\n      <td>39289876.0</td>\n      <td>1.359651e+12</td>\n      <td>34605.628084</td>\n      <td>0.086152</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>AR</td>\n      <td>2007</td>\n      <td>-0.020117</td>\n      <td>8.969801e+11</td>\n      <td>0.629139</td>\n      <td>39684303.0</td>\n      <td>1.425727e+12</td>\n      <td>35926.734575</td>\n      <td>0.038176</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>AR</td>\n      <td>2008</td>\n      <td>0.000733</td>\n      <td>1.149646e+12</td>\n      <td>0.757753</td>\n      <td>40080159.0</td>\n      <td>1.517178e+12</td>\n      <td>37853.600252</td>\n      <td>0.053633</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#3297a454 .cell execution_count=22}\n``` {.python .cell-code}\n# GII and GDP\n# Rename columns\ncombined_data = combined_data.rename(columns = {\n    \"ref_area\": \"Country\",\n    \"time_period\": \"Time\",\n    \"pct_change\": \"GII_change\"\n})\n\n# Display the GDP data in a web browser\n# view_dataframe_in_browser(combined_data)\n\n# Check the combined dataset\ncombined_data.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=59}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Country</th>\n      <th>Time</th>\n      <th>GII_change</th>\n      <th>adjusted_nominal</th>\n      <th>adjusted_index</th>\n      <th>adjusted_population</th>\n      <th>Real_GDP_domestic</th>\n      <th>Real_GDP_per_capita</th>\n      <th>GDP_change</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>AR</td>\n      <td>2004</td>\n      <td>-0.021896</td>\n      <td>4.851153e+11</td>\n      <td>0.409672</td>\n      <td>38491970.0</td>\n      <td>1.184155e+12</td>\n      <td>30763.687776</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>AR</td>\n      <td>2005</td>\n      <td>-0.008581</td>\n      <td>5.825382e+11</td>\n      <td>0.470108</td>\n      <td>38892924.0</td>\n      <td>1.239159e+12</td>\n      <td>31860.772776</td>\n      <td>0.035662</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>AR</td>\n      <td>2006</td>\n      <td>0.007379</td>\n      <td>7.159043e+11</td>\n      <td>0.526535</td>\n      <td>39289876.0</td>\n      <td>1.359651e+12</td>\n      <td>34605.628084</td>\n      <td>0.086152</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>AR</td>\n      <td>2007</td>\n      <td>-0.020117</td>\n      <td>8.969801e+11</td>\n      <td>0.629139</td>\n      <td>39684303.0</td>\n      <td>1.425727e+12</td>\n      <td>35926.734575</td>\n      <td>0.038176</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>AR</td>\n      <td>2008</td>\n      <td>0.000733</td>\n      <td>1.149646e+12</td>\n      <td>0.757753</td>\n      <td>40080159.0</td>\n      <td>1.517178e+12</td>\n      <td>37853.600252</td>\n      <td>0.053633</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Data Visualization\n### Scatterplot\nScatterplot use dots to represent values of two numeric variables. The horizontal axis was the percent change in Real GDP per capita. The vertical axis was the percent change in Gender Inequality Index(GII). Different colors represented different countries. We used a linear regression line to display the overall pattern. \n\nBased on the scatterplot, it seemed like there was a slight positive relationship between GDP change and GII change as shown by the flat regression line. Gender inequality was decreasing (gender equality was improving) a little faster in country-years with low GDP growth and a little slower in country-years with high GDP growth.\n\n::: {#957f4479 .cell execution_count=23}\n``` {.python .cell-code}\n# Drop NAs\ncombined_data = combined_data.dropna(subset=['GDP_change', 'GII_change'])\n\n# Plot the data points\nplt.figure(figsize=(18, 10))\nfor country in combined_data['Country'].unique():\n    country_data = combined_data[combined_data['Country'] == country]\n    plt.scatter(country_data['GDP_change'], country_data['GII_change'],\n             marker='o',linestyle='-', label=country)\nplt.title('Country-Year Analysis of GDP Change vs. GII Change')\nplt.xlabel('Percent Change in Real GDP per Capita (Country-Year)')\nplt.ylabel('Percent Change in GII (Country-Year)')\nplt.grid(True)\n\n# Prepare data for linear regression\nX = combined_data['GDP_change'].values.reshape(-1, 1)\ny = combined_data['GII_change'].values\n\n# Perform linear regression\nreg = LinearRegression().fit(X, y)\ny_pred = reg.predict(X)\n\n# Plot the regression line\nplt.plot(combined_data['GDP_change'], y_pred, color='red', linewidth=2)\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](imfp_demo_files/figure-html/cell-24-output-1.png){width=1418 height=819}\n:::\n:::\n\n\n### Time Series Line Plot\nWe created separate line plots for GDP change and GII change over time for a few key countries might show the trends more clearly. \n\nUS: United States\n\nJP: Japan\n\nGB: United Kindom\n\nFR: France\n\nMX: Mexico\n\nBased on the line plots, we saw GDP change and GII change have different patterns. For example, in Mexico, when there was a big change in real GDP per captia in 1995, the change in GII was pretty stable. \n\n::: {#112d00b2 .cell execution_count=24}\n``` {.python .cell-code}\n# Time Series Line plot for a few key countries\nselected_countries  = ['US', 'JP', 'GB', 'FR', 'MX']\ncombined_data_selected = combined_data[combined_data['Country'].isin(selected_countries)]\n\n# Set up the Plot Structure\nfig, ax = plt.subplots(2, 1, figsize=(18, 10), sharex=True)\n\n# Plot change in real GDP per capita over time\nsns.lineplot(data = combined_data_selected, x = \"Time\", y = \"GDP_change\", hue = \"Country\", ax = ax[0])\nax[0].set_title(\"Percent Change in Real GDP per Capita Over Time\")\nax[0].set_ylabel(\"Percent Change in Real GDP per Capita\")\n\n# Plot change in GII over time\nsns.lineplot(data = combined_data_selected, x = \"Time\", y = \"GII_change\", hue = \"Country\", ax = ax[1])\nax[1].set_title(\"Percent Change in GII over Time\")\nax[1].set_xlabel(\"Time\")\nax[1].set_ylabel(\"GII\")\n\nplt.tight_layout\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](imfp_demo_files/figure-html/cell-25-output-1.png){width=1427 height=819}\n:::\n:::\n\n\n### Barplot\nWe used a barplot to show average changes in GII and GDP percent change for each country to visualize regions where inequality was improving or worsening. \n\nThis plot supported our previous observation how GII change seemed to be not be correlated with GDP change. We also saw that, for country SI, Solvenia, there seems to be a large improvement in gender inequality.  \n\n::: {#bd067033 .cell execution_count=25}\n``` {.python .cell-code}\n# Barplot using average GII and GDP change\n# Calculate average change for each country\ncombined_data_avg = combined_data.groupby('Country')[['GII_change','GDP_change']].mean().reset_index()\n\n# Prepare to plot structure \nplt.figure(figsize = (18,10))\n\n# Create the barplot\ncombined_data_avg.plot(kind = 'bar', x = 'Country')\nplt.ylabel('Average Change')\nplt.xlabel('Country')\nplt.legend(['GII change', 'GDP change'])\nplt.grid(axis = 'y')\n\n# Show the plot\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 1728x960 with 0 Axes>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](imfp_demo_files/figure-html/cell-26-output-2.png){width=619 height=442}\n:::\n:::\n\n\n### Boxplot\nWe used boxplot to visualize the distribution of GDP and GII change by country, providing information about spread, median, and potential outliers. To provide a more informative view, we sequenced countries in an ascending order by the median of percent change in GDP.\n\nThe boxplot displayed a slight upward trend with no obvious pattern between GDP and GII change. In coutries with higher GDP change median, they also tend to have a larger spread of the GDP change. The median of GII change remained stable regardless of the magnitude of GDP change, implying weak or no association between GDP and GII change. We observed a potential outlier for country SI, Solvenia, which may explained its large improvement in Gender inequality. \n\n::: {#f89bd59b .cell execution_count=26}\n``` {.python .cell-code}\n# Box plot for GII and GDP change\n# Melt the dataframe to long format for combined boxplot\ncombined_data_melted = combined_data.melt(id_vars=['Country'], value_vars=['GII_change', 'GDP_change'], \n                                          var_name='Change_Type', value_name='Value')\n\ngdp_medians = combined_data.groupby('Country')['GDP_change'].median().sort_values()\n\ncombined_data_melted['Country'] = pd.Categorical(combined_data_melted['Country'], categories=gdp_medians.index, ordered= True)\n\n# Prepare the plot structure\nplt.figure(figsize=(18, 10))\nsns.boxplot(data = combined_data_melted, x = \"Country\", y = 'Value', hue = 'Change_Type')\nplt.title('Distribution of GII and GDP change by Country')\nplt.xlabel('Country')\nplt.ylabel('Change')\nplt.legend(title = 'Change Type')\n\n# Show the plot\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](imfp_demo_files/figure-html/cell-27-output-1.png){width=1418 height=819}\n:::\n:::\n\n\n### Correlation Matrix\nWe created a heatmap to show the relationship between GII and GDP change.\n\nA positive correlation coefficient indicates a positive relationship: the larger the GDP change, the larger the GII change. A negative correlation coefficient indicates a negative relationship: the larger the GDP change, the smaller the GII change. A correlation coefficient closer to 0 indicates there is weak or no relationship. \n\nBased on the numeric values in the plot, there was a moderately strong positive correlation between GII and GDP change for country Estonia(EE) and Ireland(IE). \n\n::: {#ba1f8035 .cell execution_count=27}\n``` {.python .cell-code}\n# Calculate the correlation\ncountry_correlation = combined_data.groupby('Country')[['GII_change', 'GDP_change']].corr().iloc[0::2, -1].reset_index(name='Correlation')\n\n# Put the correlation value in a matrix format\ncorrelation_matrix = country_correlation.pivot(index='Country', columns='level_1', values='Correlation')\n\n# Check for NaN values in the correlation matrix\ncorrelation_matrix.fillna(0, inplace=True)  # Replace NaNs with 0 or another value as appropriate\n\n# Set up the plot structure\nplt.figure(figsize=(18, 12))  # Adjust height to give more space for y-axis labels\n\n# Plot the heatmap\nsns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', center=0, cbar_kws={\"shrink\": .8}, linewidths=.5)\n\n# Enhance axis labels and title\nplt.title('Heatmap for GII and GDP Change', fontsize=20)\nplt.xlabel('Variables', fontsize=16)\nplt.ylabel('Country', fontsize=16)\n\n# Improve readability of y-axis labels\nplt.yticks(fontsize=12)  # Adjust the font size for y-axis labels\n\n# Show the plot\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](imfp_demo_files/figure-html/cell-28-output-1.png){width=1295 height=983}\n:::\n:::\n\n\n## Statistical Analysis \n### Descriptive Statistics\nThere was a total of 915 data points. The mean of the GII change in -0.0314868, which indicated the overall grand mean percent change in gender inequality index is -3.15%. The mean of the GDP change was 0.0234633, showing the overall grand mean percent change in real GDP per capita was 2.35%. \n\n::: {#df63546e .cell execution_count=28}\n``` {.python .cell-code}\n# Generate summary statistics\ndescriptive_stats = combined_data.describe()\nprint(tabulate(descriptive_stats, headers='keys', tablefmt='github'))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n|       |   GII_change |   adjusted_nominal |   adjusted_index |   adjusted_population |   Real_GDP_domestic |   Real_GDP_per_capita |   GDP_change |\n|-------|--------------|--------------------|------------------|-----------------------|---------------------|-----------------------|--------------|\n| count | 914          |      914           |      914         |         914           |       914           |         914           | 914          |\n| mean  |  -0.0314506  |        7.85541e+13 |        0.855504  |           4.50061e+07 |         7.60737e+13 |           1.00595e+06 |   0.023532   |\n| std   |   0.054783   |        6.01311e+14 |        0.210057  |           1.24493e+08 |         5.52717e+14 |           3.88155e+06 |   0.0418127  |\n| min   |  -0.755003   |        2.18714e+09 |        0.0360636 |      396324           |         5.21733e+09 |        1798.42        |  -0.285847   |\n| 25%   |  -0.0424105  |        1.07655e+11 |        0.743355  |           5.0737e+06  |         1.48206e+11 |       17176           |   0.00384809 |\n| 50%   |  -0.020248   |        7.50706e+11 |        0.888883  |           1.0337e+07  |         9.94933e+11 |       35401           |   0.0222486  |\n| 75%   |  -0.00451301 |        2.5911e+12  |        1.00175   |           4.5159e+07  |         2.9412e+12  |      120391           |   0.0427318  |\n| max   |   0.156992   |        9.54613e+15 |        2.0788    |           1.28084e+09 |         7.92007e+15 |           3.14532e+07 |   0.241984   |\n```\n:::\n:::\n\n\n### Regression Analysis\nSimple linear regression as a foundational approach provide us with a basic understanding of the relationship between GDP change and GII change. \n\nBased on the summary, we concluded the following:\n\n* Becasue p-value = 0.057, if we set alpha, the significance level, to be 0.05, we failed to reject the null hypothesis and conclude there was no significant relationship between percent change in real GDP per capita and gender inequality index. \n\n* R-squared = 0.004. Only 0.4% of the variance in GII change could be explained by GDP change.\n\n* We were 95% confident that the interval from -0.003 to 0.169 captured the true slope of GDP change. Because 0 was included, we are uncertain about the effect of GDP change on GII chnage.\n\n::: {#4bc68e53 .cell execution_count=29}\n``` {.python .cell-code}\n# Define independent and depenent variables\nX = combined_data['GDP_change']\ny = combined_data['GII_change']\n\n# Add a constant to indepdent variable to include an intercept\nX = sm.add_constant(X)\n\n# Fit a simple linear regresion model and print out the summary\nmodel = sm.OLS(y, X).fit()\nprint(model.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:             GII_change   R-squared:                       0.004\nModel:                            OLS   Adj. R-squared:                  0.003\nMethod:                 Least Squares   F-statistic:                     3.551\nDate:                Wed, 25 Dec 2024   Prob (F-statistic):             0.0598\nTime:                        18:00:11   Log-Likelihood:                 1360.0\nNo. Observations:                 914   AIC:                            -2716.\nDf Residuals:                     912   BIC:                            -2706.\nDf Model:                           1                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nconst         -0.0334      0.002    -16.069      0.000      -0.037      -0.029\nGDP_change     0.0816      0.043      1.885      0.060      -0.003       0.167\n==============================================================================\nOmnibus:                      841.660   Durbin-Watson:                   1.384\nProb(Omnibus):                  0.000   Jarque-Bera (JB):            53999.190\nSkew:                          -3.938   Prob(JB):                         0.00\nKurtosis:                      39.823   Cond. No.                         23.9\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n### Time Series Analysis\nTime series analysis allows us to explore how the relationship between GII and GDP change vary across different time periods, accounting for lagged effects. \n\nHere was a quick summary of the result:\n* Both GII and GDP change time series were stationary.\n\n* Past GII change values significantly influenced cuurent GII change values.\n\n* VAR model had good model performance on forecasting future values based on historical data. \n\n* Changes in GDP did not cause/precde the changes in GII. \n\n#### ADF Test: Stationality Assumption Check\nWe wanted to use Augmented Dickey-Fuller (ADF) test to check whether a time series was stationary, which was the model assumption for many time series models. \n\nStationarity implied constant mean and variance over time, making it more predictable and stable for forecasting. \n\nBased on the ADF test output, both GII and GDP change time series were stationary. We proceeded to the time series modeling section. \n\n::: {#de640f07 .cell execution_count=30}\n``` {.python .cell-code}\n# Augmented Dickey-Fuller (ADF) test for stationarity check\n# Create melted datasets\ncombined_data_time = combined_data.melt(id_vars=['Time', 'Country'], value_vars=['GII_change','GDP_change'], var_name = 'Change_Type', value_name = 'Value')\nGII = combined_data_time[(combined_data_time['Change_Type'] == 'GII_change')]                         \n\nGDP = combined_data_time[(combined_data_time['Change_Type'] == 'GDP_change')]\n\n# Stationary Check\ndef adf_test(series):\n    result = adfuller(series.dropna())\n    print(f'ADF Statistic: {result[0]}')\n    print(f'p-value: {result[1]}')\n    if result[1] < 0.05:\n        print(\"Series is stationary\")\n    else:\n        print(\"Series is not stationary\")\n\n# Output the result\nadf_test(GII['Value'])\nadf_test(GDP['Value'])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nADF Statistic: -16.069430375623295\np-value: 5.527565277907626e-29\nSeries is stationary\nADF Statistic: -8.535683414310181\np-value: 1.0095278443825336e-13\nSeries is stationary\n```\n:::\n:::\n\n\n#### VAR model: Examine variables separately\nWe fitted a VAR (Vector Autoreression) model to see the relationship between GII and GDP change. VAR is particularly useful when dealing with multivariate time series data and allows us to examine the interdependence between variables. \n\nBased on summary, here were several interpretations we could make:\n\n* We used AIC as the criteria for model selection. Lower value suggests a better fit. \n\n* Given that we wanted to predict GII change, we focused on the first set \"Results for equation GII_change.\"\n\n* Past GII_change values significantly influenced current GII_change, as shown in the small p-values of lags 1 and 2. \n\n* Lag 2 of GDP_change had a relatively low p-value but is not statistically significant.\n\n::: {#b2bae2f8 .cell execution_count=31}\n``` {.python .cell-code}\n# Split the dataset into training and testing sets\nsplit_ratio = 0.7\nsplit_index = int(len(combined_data) * split_ratio)\n\n# Training set is used to fit the model\ntrain_data = combined_data.iloc[:split_index]\n\n# Testing set is used for validation\ntest_data = combined_data.iloc[split_index:]\n\nprint(f\"Training data: {train_data.shape}\")\nprint(f\"Test data: {test_data.shape}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTraining data: (639, 9)\nTest data: (275, 9)\n```\n:::\n:::\n\n\n::: {#1fc977b8 .cell execution_count=32}\n``` {.python .cell-code}\n# Fit a VAR model \ntime_model = VAR(train_data[['GII_change', 'GDP_change']])\ntime_model_fitted = time_model.fit(maxlags = 15, ic=\"aic\")\n\n# Print out the model summary\nprint(time_model_fitted.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Summary of Regression Results   \n==================================\nModel:                         VAR\nMethod:                        OLS\nDate:           Wed, 25, Dec, 2024\nTime:                     18:00:11\n--------------------------------------------------------------------\nNo. of Equations:         2.00000    BIC:                   -12.2270\nNobs:                     636.000    HQIC:                  -12.2869\nLog likelihood:           2128.47    FPE:                4.43927e-06\nAIC:                     -12.3250    Det(Omega_mle):     4.34314e-06\n--------------------------------------------------------------------\nResults for equation GII_change\n================================================================================\n                   coefficient       std. error           t-stat            prob\n--------------------------------------------------------------------------------\nconst                -0.023760         0.003176           -7.481           0.000\nL1.GII_change         0.211342         0.039900            5.297           0.000\nL1.GDP_change        -0.015713         0.046080           -0.341           0.733\nL2.GII_change         0.111672         0.040402            2.764           0.006\nL2.GDP_change         0.088293         0.046452            1.901           0.057\nL3.GII_change        -0.021861         0.039774           -0.550           0.583\nL3.GDP_change         0.000651         0.046141            0.014           0.989\n================================================================================\n\nResults for equation GDP_change\n================================================================================\n                   coefficient       std. error           t-stat            prob\n--------------------------------------------------------------------------------\nconst                 0.014585         0.002720            5.362           0.000\nL1.GII_change         0.004128         0.034171            0.121           0.904\nL1.GDP_change         0.141566         0.039464            3.587           0.000\nL2.GII_change        -0.009734         0.034600           -0.281           0.778\nL2.GDP_change         0.044282         0.039782            1.113           0.266\nL3.GII_change        -0.037787         0.034063           -1.109           0.267\nL3.GDP_change         0.143870         0.039516            3.641           0.000\n================================================================================\n\nCorrelation matrix of residuals\n              GII_change  GDP_change\nGII_change      1.000000    0.040992\nGDP_change      0.040992    1.000000\n\n\n\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/Users/sammi/Library/Caches/pypoetry/virtualenvs/imfp-0AlIckOY-py3.13/lib/python3.13/site-packages/statsmodels/tsa/base/tsa_model.py:473: ValueWarning: An unsupported index was provided. As a result, forecasts cannot be generated. To use the model for forecasting, use one of the supported classes of index.\n  self._init_dates(dates, freq)\n```\n:::\n:::\n\n\n#### VAR Model: Forecasting\nWe applied the model learned above to the test data. Based on the plot, the forecast values seem to follow the actual data well, indicating a good model fit caputuring the underlying trends.\n\n::: {#8bdea4e9 .cell execution_count=33}\n``` {.python .cell-code}\n# Number of steps to forecast (length of the test set)\nn_steps = len(test_data)\n\n# Get the last values from the training set for forecasting\nforecast_input = train_data[['GII_change', 'GDP_change']].values[-time_model_fitted.k_ar:]\n\n# Forecasting\nforecast = time_model_fitted.forecast(y=forecast_input, steps=n_steps)\n\n# Create a DataFrame for the forecasted values\nforecast_df = pd.DataFrame(forecast, index=test_data.index, columns=['GII_forecast', 'GDP_forecast'])\n\n# Ensure the index of the forecast_df matches the test_data index\nforecast_df.index = test_data.index\n```\n:::\n\n\n::: {#ee965439 .cell execution_count=34}\n``` {.python .cell-code}\nplt.figure(figsize=(12, 6))\nplt.plot(train_data['GII_change'], label='Training GII', color='blue')\nplt.plot(test_data['GII_change'], label='Actual GII', color='orange')\nplt.plot(forecast_df['GII_forecast'], label='Forecasted GII', color='green')\nplt.title('GII Change Forecast vs Actual')\nplt.legend()\nplt.show()\n\nplt.figure(figsize=(12, 6))\nplt.plot(train_data['GDP_change'], label='Training GDP', color='blue')\nplt.plot(test_data['GDP_change'], label='Actual GDP', color='orange')\nplt.plot(forecast_df['GDP_forecast'], label='Forecasted GDP', color='green')\nplt.title('GDP Change Forecast vs Actual')\nplt.legend()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](imfp_demo_files/figure-html/cell-35-output-1.png){width=957 height=505}\n:::\n\n::: {.cell-output .cell-output-display}\n![](imfp_demo_files/figure-html/cell-35-output-2.png){width=957 height=505}\n:::\n:::\n\n\n#### VAR Model: Model Performance\nLow values of both MAE and RMSE indicate good model performance with small average errors in predictions. \n\n::: {#d2fefb01 .cell execution_count=35}\n``` {.python .cell-code}\nmae_gii = mean_absolute_error(test_data['GII_change'], forecast_df['GII_forecast'])\nmae_gdp = mean_absolute_error(test_data['GDP_change'], forecast_df['GDP_forecast'])\n\nprint(f'Mean Absolute Error for GII: {mae_gii}')\nprint(f'Mean Absolute Error for GDP: {mae_gdp}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nMean Absolute Error for GII: 0.03296113056900485\nMean Absolute Error for GDP: 0.027636232780964363\n```\n:::\n:::\n\n\n::: {#c10b70b8 .cell execution_count=36}\n``` {.python .cell-code}\nrmse_gii = np.sqrt(mean_squared_error(test_data['GII_change'], forecast_df['GII_forecast']))\nrmse_gdp = np.sqrt(mean_squared_error(test_data['GDP_change'], forecast_df['GDP_forecast']))\n\nprint(f'RMSE for GII: {rmse_gii}')\nprint(f'RMSE for GDP: {rmse_gdp}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRMSE for GII: 0.06284754560659174\nRMSE for GDP: 0.038429216092797085\n```\n:::\n:::\n\n\n#### VAR Model: Granger causality test\nGranger causality test evaluates whether one time series can predict another. \n\nBased on the output, the lowest p-value is when lag = 2. However, because p-value > 0.05, we fail to reject the null hypothesis and conclude the GDP_change does not Granger-cause the GII_change.\n\n::: {#2d30dfa3 .cell execution_count=37}\n``` {.python .cell-code}\n# Perform the Granger causality test\nmax_lag = 3\ntest_result = grangercausalitytests(train_data[['GII_change', 'GDP_change']], max_lag, verbose=True)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nGranger Causality\nnumber of lags (no zero) 1\nssr based F test:         F=0.0000  , p=0.9972  , df_denom=635, df_num=1\nssr based chi2 test:   chi2=0.0000  , p=0.9972  , df=1\nlikelihood ratio test: chi2=0.0000  , p=0.9972  , df=1\nparameter F test:         F=0.0000  , p=0.9972  , df_denom=635, df_num=1\n\nGranger Causality\nnumber of lags (no zero) 2\nssr based F test:         F=1.8529  , p=0.1576  , df_denom=632, df_num=2\nssr based chi2 test:   chi2=3.7351  , p=0.1545  , df=2\nlikelihood ratio test: chi2=3.7242  , p=0.1553  , df=2\nparameter F test:         F=1.8529  , p=0.1576  , df_denom=632, df_num=2\n\nGranger Causality\nnumber of lags (no zero) 3\nssr based F test:         F=1.2359  , p=0.2958  , df_denom=629, df_num=3\nssr based chi2 test:   chi2=3.7489  , p=0.2899  , df=3\nlikelihood ratio test: chi2=3.7379  , p=0.2912  , df=3\nparameter F test:         F=1.2359  , p=0.2958  , df_denom=629, df_num=3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/Users/sammi/Library/Caches/pypoetry/virtualenvs/imfp-0AlIckOY-py3.13/lib/python3.13/site-packages/statsmodels/tsa/stattools.py:1556: FutureWarning: verbose is deprecated since functions should not print results\n  warnings.warn(\n```\n:::\n:::\n\n\n## Conclusion\nIn wrapping up our analysis, we found no evidence to support a significant relationship between the Change in Real GDP per capita and the Change in the Gender Inequality Index (GII). This suggests that economic growth may not have a direct impact on gender equality. However, our findings open the door to questions for future research. Check out the blog for full analysis!\n\n",
    "supporting": [
      "imfp_demo_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}